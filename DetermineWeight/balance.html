<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Cómic Pensamiento Crítico</title>
    <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var width=800;
var height=600;
var game = new Phaser.Game(width, height, Phaser.CANVAS, '', { preload: preload, create: create, update: update, render: render});

var fondo;
var floors;
var rocks;
var pivs;
var plates;
var block1;
var block2;
var block3;
var measure1={blockused: false, plw: 0, prw: 0, pl: null, pr: null, result: null, name: "1", midtext: "", cx: 0, cy: 0, intable: false, ok: null };
var measure2={blockused: false, plw: 0, prw: 0, pl: null, pr: null, result: null, name: "2", midtext: "", cx: 0, cy: 0, intable: false, ok: null};
var measure3={blockused: false, plw: 0, prw: 0, pl: null, pr: null, result: null, name: "3", midtext: "", cx: 0, cy: 0, intable: false, ok: null};
var button1;
var button11;
var button2;
var button21;
var button3;
var button31;
var tableup={fulltable: false, lines: null, measures: 0 };

var pivImg1;
var pivImg2;
var pivImg3;
var pesaBmayADer1;
var pesaBmayAIzq1;
var pesaCmayAIzq1;
var pesaCmayADer1;
var pesaCmayBDer1;
var pesaCmayBIzq1;
var pesaAigualA1;
var pesaBigualB1;
var pesaCigualC1;
var pesaBmayADer2;
var pesaBmayAIzq2;
var pesaCmayAIzq2;
var pesaCmayADer2;
var pesaCmayBDer2;
var pesaCmayBIzq2;
var pesaAigualA2;
var pesaBigualB2;
var pesaCigualC2;
var pesaBmayADer3;
var pesaBmayAIzq3;
var pesaCmayAIzq3;
var pesaCmayADer3;
var pesaCmayBDer3;
var pesaCmayBIzq3;
var pesaAigualA3;
var pesaBigualB3;
var pesaCigualC3;
var style = { font: "12px Arial", align: "center" };
var textA=null;
var textB=null;
var textC=null;
var right;
var mAdone=false;
var mBdone=false;
var mCdone=false;
var tutorial_button;

var A_p;
var B_p;
var C_p;
var right_p;
var block1_p;
var block2_p;
var block3_p;
var pivImg1_p;
var pivImg2_p;
var pivImg3_p;
var tutorial_button_p;
var textA_p;
var textB_p;
var textC_p;
var ground_p;
var p1l_p;
var p1r_p;
var p2l_p;
var p2r_p;
var p3l_p;
var p3r_p;
var voice;
var voice_button;
var voice_button_p;


function preload(){
    game.load.image('ground', 'assetsImg/piso.png');
	game.load.image('A', 'assetsImg/A.png');
    game.load.image('B', 'assetsImg/B.png');
    game.load.image('C', 'assetsImg/C.png');
    game.load.image('back', 'assetsImg/backB.png');
    game.load.image('piv', 'assetsImg/pesa2.png');
    game.load.image('platei', 'assetsImg/pivote2d_3.png');
    game.load.image('plated', 'assetsImg/pivote2d_3.png');
    game.load.image('block', 'assetsImg/block.png');
    game.load.spritesheet('basurero', 'assetsImg/delete_2.png', 66,67);
    game.load.spritesheet('add', 'assetsImg/shapes_2.png', 72,71);
    game.load.image('tfull', 'assetsImg/tablaCompleta2.png');
    game.load.spritesheet('tools', 'assetsImg/choose_tool.png', 113,60);
    game.load.image('ok', 'assetsImg/k.png');
	game.load.image('pesaBmayADer', 'assetsImg/pesaBmayADer2.png');
	game.load.image('pesaBmayAIzq', 'assetsImg/pesaBmayAIzq2.png');
	game.load.image('pesaCmayADer', 'assetsImg/pesaCmayADer2.png');
	game.load.image('pesaCmayBIzq', 'assetsImg/pesaCmayBIzq2.png');
	game.load.image('pesaCmayBDer', 'assetsImg/pesaCmayBDer2.png');
	game.load.image('pesaCmayAIzq', 'assetsImg/pesaCmayAIzq2.png');
	game.load.image('pesaAigualA', 'assetsImg/pesaAigualA2.png');
	game.load.image('pesaBigualB', 'assetsImg/pesaBigualB2.png');
	game.load.image('pesaCigualC', 'assetsImg/pesaCigualC2.png');
	game.load.spritesheet('right', 'assetsImg/arrowright_2.png',89,89);
    game.load.audio('voice', 'assetsAudio/voiceTest2.mp3');
    game.load.spritesheet('voice_button', 'assetsImg/button_voice3_50.png', 50, 50);
	game.load.spritesheet('button_tutorial','assetsImg/go_tutorial.png',98,46);
	game.load.spritesheet('b10v', 'assetsImg/b10v.png', 113, 61);
	A_p=[557, 73];
    B_p=[630, 73];
    C_p=[700, 73];
    block1_p=[112,343];
	block2_p=[279,343];
	block3_p=[446,343];
    right_p=[700, 500];
    pivImg1_p=[block1_p[0],block1_p[1]+50];
	pivImg2_p=[block2_p[0],block2_p[1]+50];
	pivImg3_p=[block3_p[0],block3_p[1]+50];
	tutorial_button_p=[50,50];
	textA_p=[677, 268];
    textB_p=[677, 336];
    textC_p=[677, 404];
    ground_p=[535,190];
    p1l_p=[pivImg1_p[0]-20, pivImg1_p[1]-10];
	p1r_p=[pivImg1_p[0]+20, pivImg1_p[1]-10];
	p2l_p=[pivImg2_p[0]-20, pivImg2_p[1]-10];
	p2r_p=[pivImg2_p[0]+20, pivImg2_p[1]-10];
	p3l_p=[pivImg3_p[0]-20, pivImg3_p[1]-10];
	p3r_p=[pivImg3_p[0]+20, pivImg3_p[1]-10];
	measure1.cx=textA_p[0];
	measure1.cy=textA_p[1];
	measure2.cx=textB_p[0];
	measure2.cy=textB_p[1];
	measure3.cx=textC_p[0];
	measure3.cy=textC_p[1];
	voice_button_p= [80, 120];

}
function create(){
	game.physics.startSystem(Phaser.Physics.ARCADE);
	game.physics.arcade.gravity.y = 100;
	game.stage.backgroundColor = "#FFFFFF";
	fondo=game.add.sprite(0,0, 'back');
	voice=game.add.audio('voice');
	voice.play();
	voice_button = game.add.button(voice_button_p[0], voice_button_p[1], 'voice_button', play_sound ,this, 0);
	//tutorial_button=game.add.button(tutorial_button_p[0], tutorial_button_p[1],'button_tutorial', watch_tutorial, this);
	tools_button=game.add.button(tutorial_button_p[0], tutorial_button_p[1],'tools', goTools, this,0);

	//Se crean los tres bloques de medición.
	block1=game.add.sprite(block1_p[0], block1_p[1],'block');
	block1.enableBody=true;
	block1.anchor.setTo(0.5);
	block2=game.add.sprite(block2_p[0], block2_p[1],'block');
	block2.enableBody=true;
	block2.anchor.setTo(0.5);
	block3=game.add.sprite(block3_p[0], block3_p[1],'block');
	block3.enableBody=true;
	block3.anchor.setTo(0.5);
	//Colocamos floors o pisos para las rocas que arrastraremos, y habilitamos la fisica para cualquier objeto dentro de este grupo
	floors=game.add.group();
	floors.enableBody=true;
	var floor1= floors.create(ground_p[0], ground_p[1], 'ground');
	floor1.body.immovable=true;
	floor1.body.allowGravity=false;

	//balanzas
	pivImg1=game.add.sprite(pivImg1_p[0], pivImg1_p[1],'piv');
	pivImg1.anchor.setTo(0.5);
	pivImg2=game.add.sprite(pivImg2_p[0], pivImg2_p[1],'piv');
	pivImg2.anchor.setTo(0.5);
	pivImg3=game.add.sprite(pivImg3_p[0], pivImg3_p[1],'piv');
	pivImg3.anchor.setTo(0.5);
	//imagenes de cual pesa más
	pesaBmayADer1=game.add.image(pivImg1_p[0], pivImg1_p[1]-80,'pesaBmayADer');
	pesaBmayADer1.visible=false;
	pesaBmayADer1.anchor.setTo(0.5);
	pesaBmayAIzq1=game.add.image(pivImg1_p[0], pivImg1_p[1]-80,'pesaBmayAIzq');
	pesaBmayAIzq1.visible=false;
	pesaBmayAIzq1.anchor.setTo(0.5);
	pesaCmayADer1=game.add.image(pivImg1_p[0], pivImg1_p[1]-80,'pesaCmayADer');
	pesaCmayADer1.visible=false;
	pesaCmayADer1.anchor.setTo(0.5);
	pesaCmayAIzq1=game.add.image(pivImg1_p[0], pivImg1_p[1]-80,'pesaCmayAIzq');
	pesaCmayAIzq1.visible=false;
	pesaCmayAIzq1.anchor.setTo(0.5);
	pesaCmayBDer1=game.add.image(pivImg1_p[0], pivImg1_p[1]-80,'pesaCmayBDer');
	pesaCmayBDer1.visible=false;
	pesaCmayBDer1.anchor.setTo(0.5);
	pesaCmayBIzq1=game.add.image(pivImg1_p[0], pivImg1_p[1]-80,'pesaCmayBIzq');
	pesaCmayBIzq1.visible=false;
	pesaCmayBIzq1.anchor.setTo(0.5);
	pesaAigualA1=game.add.image(pivImg1_p[0], pivImg1_p[1]-80,'pesaAigualA');
	pesaAigualA1.visible=false;
	pesaAigualA1.anchor.setTo(0.5);
	pesaBigualB1=game.add.image(pivImg1_p[0], pivImg1_p[1]-80,'pesaBigualB');
	pesaBigualB1.visible=false;
	pesaBigualB1.anchor.setTo(0.5);
	pesaCigualC1=game.add.image(pivImg1_p[0], pivImg1_p[1]-80,'pesaCigualC');
	pesaCigualC1.visible=false;
	pesaCigualC1.anchor.setTo(0.5);

	pesaBmayADer2=game.add.image(pivImg2_p[0], pivImg2_p[1]-80,'pesaBmayADer');
	pesaBmayADer2.visible=false;
	pesaBmayADer2.anchor.setTo(0.5);
	pesaBmayAIzq2=game.add.image(pivImg2_p[0], pivImg2_p[1]-80,'pesaBmayAIzq');
	pesaBmayAIzq2.visible=false;
	pesaBmayAIzq2.anchor.setTo(0.5);
	pesaCmayADer2=game.add.image(pivImg2_p[0], pivImg2_p[1]-80,'pesaCmayADer');
	pesaCmayADer2.visible=false;
	pesaCmayADer2.anchor.setTo(0.5);
	pesaCmayAIzq2=game.add.image(pivImg2_p[0], pivImg2_p[1]-80,'pesaCmayAIzq');
	pesaCmayAIzq2.visible=false;
	pesaCmayAIzq2.anchor.setTo(0.5);
	pesaCmayBDer2=game.add.image(pivImg2_p[0], pivImg2_p[1]-80,'pesaCmayBDer');
	pesaCmayBDer2.visible=false;
	pesaCmayBDer2.anchor.setTo(0.5);
	pesaCmayBIzq2=game.add.image(pivImg2_p[0], pivImg2_p[1]-80,'pesaCmayBIzq');
	pesaCmayBIzq2.visible=false;
	pesaCmayBIzq2.anchor.setTo(0.5);
	pesaAigualA2=game.add.image(pivImg2_p[0], pivImg2_p[1]-80,'pesaAigualA');
	pesaAigualA2.visible=false;
	pesaAigualA2.anchor.setTo(0.5);
	pesaBigualB2=game.add.image(pivImg2_p[0], pivImg2_p[1]-80,'pesaBigualB');
	pesaBigualB2.visible=false;
	pesaBigualB2.anchor.setTo(0.5);
	pesaCigualC2=game.add.image(pivImg2_p[0], pivImg2_p[1]-80,'pesaCigualC');
	pesaCigualC2.visible=false;
	pesaCigualC2.anchor.setTo(0.5);

	pesaBmayADer3=game.add.image(pivImg3_p[0], pivImg3_p[1]-80,'pesaBmayADer');
	pesaBmayADer3.visible=false;
	pesaBmayADer3.anchor.setTo(0.5);
	pesaBmayAIzq3=game.add.image(pivImg3_p[0], pivImg3_p[1]-80,'pesaBmayAIzq');
	pesaBmayAIzq3.visible=false;
	pesaBmayAIzq3.anchor.setTo(0.5);
	pesaCmayADer3=game.add.image(pivImg3_p[0], pivImg3_p[1]-80,'pesaCmayADer');
	pesaCmayADer3.visible=false;
	pesaCmayADer3.anchor.setTo(0.5);
	pesaCmayAIzq3=game.add.image(pivImg3_p[0], pivImg3_p[1]-80,'pesaCmayAIzq');
	pesaCmayAIzq3.visible=false;
	pesaCmayAIzq3.anchor.setTo(0.5);
	pesaCmayBDer3=game.add.image(pivImg3_p[0], pivImg3_p[1]-80,'pesaCmayBDer');
	pesaCmayBDer3.visible=false;
	pesaCmayBDer3.anchor.setTo(0.5);
	pesaCmayBIzq3=game.add.image(pivImg3_p[0], pivImg3_p[1]-80,'pesaCmayBIzq');
	pesaCmayBIzq3.visible=false;
	pesaCmayBIzq3.anchor.setTo(0.5);
	pesaAigualA3=game.add.image(pivImg3_p[0], pivImg3_p[1]-80,'pesaAigualA');
	pesaAigualA3.visible=false;
	pesaAigualA3.anchor.setTo(0.5);
	pesaBigualB3=game.add.image(pivImg3_p[0], pivImg3_p[1]-80,'pesaBigualB');
	pesaBigualB3.visible=false;
	pesaBigualB3.anchor.setTo(0.5);
	pesaCigualC3=game.add.image(pivImg3_p[0], pivImg3_p[1]-80,'pesaCigualC');
	pesaCigualC3.visible=false;
	pesaCigualC3.anchor.setTo(0.5);


	//Creamos los tanques, le agregamos el cuerpo solido
	rocks=game.add.group();
	rocks.enableBody=true;

	var rock1=rocks.create(A_p[0],A_p[1],'A');
	rock1.body.collideWorldBounds = true;
	rock1.body.mass=8;
	var rock2=rocks.create(B_p[0],B_p[1],'B');
	rock2.body.collideWorldBounds = true;
	rock2.body.mass=4;
	var rock3=rocks.create(C_p[0],C_p[1],'C');
	rock3.body.collideWorldBounds = true;
	rock3.body.mass=3;

	//Habilitamos el drag and drop
	rock1.inputEnabled=true;
	rock1.input.enableDrag(false,true);
	rock1.events.onDragStart.add(startDrag,this);
	rock1.events.onDragStop.add(stopDrag,this);
	rock2.inputEnabled=true;
	rock2.input.enableDrag(false,true);
	rock2.events.onDragStart.add(startDrag,this);
	rock2.events.onDragStop.add(stopDrag,this);
	rock3.inputEnabled=true;
	rock3.input.enableDrag(false,true);
	rock3.events.onDragStart.add(startDrag,this);
	rock3.events.onDragStop.add(stopDrag,this);

	//Creamos platos de las balanzas.
	plates=game.add.group();
	plates.enableBody=true;

	var p1l=plates.create(p1l_p[0], p1l_p[1],'platei');
	p1l.body.immovable=true;
	p1l.body.allowGravity=false;
	p1l.anchor.setTo(0.5);
	var p1r=plates.create(p1r_p[0], p1r_p[1],'plated');
	p1r.body.immovable=true;
	p1r.body.allowGravity=false;
	p1r.anchor.setTo(0.5);

	var p2l=plates.create(p2l_p[0], p2l_p[1],'platei');
	p2l.body.immovable=true;
	p2l.body.allowGravity=false;
	p2l.anchor.setTo(0.5);
	var p2r=plates.create(p2r_p[0], p2r_p[1],'plated');
	p2r.body.immovable=true;
	p2r.body.allowGravity=false;
	p2r.anchor.setTo(0.5);

	var p3l=plates.create(p3l_p[0], p3l_p[1],'platei');
	p3l.body.immovable=true;
	p3l.body.allowGravity=false;
	p3l.anchor.setTo(0.5);
	var p3r=plates.create(p3r_p[0], p3r_p[1],'plated');
	p3r.body.immovable=true;
	p3r.body.allowGravity=false;
	p3r.anchor.setTo(0.5);
	
	measure1.ok=game.add.sprite(165,250,'ok');
	measure1.ok.anchor.setTo(0.5);
	measure1.ok.visible=false;
	measure2.ok=game.add.sprite(330,250,'ok');
	measure2.ok.anchor.setTo(0.5);
	measure2.ok.visible=false;
	measure3.ok=game.add.sprite(500,250,'ok');
	measure3.ok.anchor.setTo(0.5);
	measure3.ok.visible=false;

	//Se agregan los botones de agregar y borrar a la tabla
	button1=game.add.button(40,480, 'basurero', eraseMeasure1, this, 1,0,2);
	button11=game.add.button(115,480, 'add', goTable1, this, 1,0,2);
	button2=game.add.button(210,480, 'basurero', eraseMeasure2, this, 1,0,2);
	button21=game.add.button(285,480, 'add', goTable2, this, 1,0,2);
	button3=game.add.button(375,480, 'basurero', eraseMeasure3, this, 1,0,2);
	button31=game.add.button(450,480, 'add', goTable3, this, 1,0,2);

	checkRight();
	reloadTable();


	console.log(sessionStorage.getItem('b_m1'));
	console.log(sessionStorage.getItem('b_m2'));
	console.log(sessionStorage.getItem('b_m3'));
}
function play_sound(){
    voice.play();
}
function checkRight(){
	console.log(sessionStorage.getItem('cameFrom'));
    if (sessionStorage.getItem('cameFrom')=='d12' || sessionStorage.getItem('cameFrom')=='d14' ){
        right=game.add.button(right_p[0]-20, right_p[1], 'b10v', goOrder, this, 1,0,2);
    }
    else{
        right=game.add.button(right_p[0], right_p[1], 'right', goRight, this, 1,0,2);
    }
    right.visible=false;
}
function reloadTable(){
	console.log(sessionStorage.getItem('b_m1'));
	if(sessionStorage.getItem('b_m1')!=null){
		textA = game.add.text(textA_p[0], textA_p[1], sessionStorage.getItem('b_m1'), style);
		tableup.measures++;
	}
	if(sessionStorage.getItem('b_m2')!=null){
		textB = game.add.text(textB_p[0], textB_p[1], sessionStorage.getItem('b_m2'), style);
		tableup.measures++;
	}
	if(sessionStorage.getItem('b_m3')!=null){
		textC = game.add.text(textC_p[0], textC_p[1], sessionStorage.getItem('b_m3'), style);
		tableup.measures++;
	}
	checkfull();
}
function checkfull(){
	if (tableup.measures>=2 && sessionStorage.getItem('i24')=="0"){
		sessionStorage.setItem('i24', '1');
	}
	if (tableup.measures>=3){
		tableup.fulltable=true;
		tableup.lines= game.add.sprite(572,220,'tfull');
		sessionStorage.setItem('b_f', 'true');
	}
}
function erasefull(){
	if(tableup.fulltable==true){
		tableup.fulltable=false;
		tableup.lines.destroy();
		sessionStorage.setItem('b_f', 'false');
	}
}
//Se permite que las rocas y el instrumento de medición colisionen. Cuando ocurra se llama a la función onTouch.
function update(){
	if((mAdone && mBdone && mCdone) || (sessionStorage.getItem('b_m1')!=null || sessionStorage.getItem('b_m2')!=null || sessionStorage.getItem('b_m3')!=null))
	{
		right.visible=true;
	}
	else {
		right.visible=false;
	}

	game.physics.arcade.collide(rocks, floors);
	game.physics.arcade.collide(rocks, plates, onTouch, null, this);
}
function onTouch(obj1, obj2){
	if(obj1.overlap(block1) && !measure1.blockused){
		console.log("Medición en 1");
		measure1.id="1";
		measure(measure1,obj1,obj2);
	} else if(obj1.overlap(block2) && !measure2.blockused){
		console.log("Medición en 2");
		measure2.id="2";
		measure(measure2,obj1,obj2);
	} else if(obj1.overlap(block3) && !measure3.blockused){
		console.log("Medición en 3");
		measure3.id="3";
		measure(measure3,obj1,obj2);
	} else {
		console.log("No area de medición");
	}
}
function measure(measureTemp, obj1, obj2){
	var text2;
	if (obj2.key=='platei'){
		measureTemp.plw=obj1.body.mass;
		measureTemp.pl=obj1;
		measureTemp.pl.body.allowGravity=false;
		measureTemp.pl.inputEnabled=false;
		measureTemp.pl.y= measureTemp.pl.y-3;

	}else{
		measureTemp.prw=obj1.body.mass;
		measureTemp.pr=obj1;
		measureTemp.pr.body.allowGravity=false;
		measureTemp.pr.inputEnabled=false;
		measureTemp.pr.y= measureTemp.pr.y-3;
	}
	if (measureTemp.plw>measureTemp.prw){
		console.log("izquierdo abajo");
		text2 = " es más\npesado que ";
		console.log(measureTemp.pl);
		console.log(measureTemp.pr);
	} else if(measureTemp.plw==measureTemp.prw){
		console.log("Iguales");
		text2 = " pesa lo\nmismo que ";
		console.log(measureTemp.pl);
		console.log(measureTemp.pr);
	}else{
		console.log("izquierdo arriba");
		text2 = " es más\nliviano que ";
		console.log(measureTemp.pl);
		console.log(measureTemp.pr);
	}
	if(measureTemp.prw!=0 && measureTemp.plw!=0){
		measureTemp.pl.visible=false;
		measureTemp.pr.visible=false;
		console.log("doMedición")
		measureTemp.midtext=text2;
		doMeasure(measureTemp);
	}
}
function doMeasure(m){
	var text = game.add.text(m.cx, m.cy,m.pl.key+m.midtext+m.pr.key, style);
	m.result=text;
	m.result.visible=false;
	m.blockused=true;
	m.ok.visible=true;

	if(m.name=="1")
	{
		mAdone=true;
		pivImg1.visible=false;
		if(m.pl.key=='A' && m.pr.key=='A')
			pesaAigualA1.visible=true;
		else if(m.pl.key=='B' && m.pr.key=='B')
			pesaBigualB1.visible=true;
		else if(m.pl.key=='C' && m.pr.key=='C')
			pesaCigualC1.visible=true;
		else if(m.pl.key=='A' && m.pr.key=='B')
			pesaBmayADer1.visible=true;
		else if(m.pl.key=='B' && m.pr.key=='A')
			pesaBmayAIzq1.visible=true;
		else if(m.pl.key=='C' && m.pr.key=='A')
			pesaCmayAIzq1.visible=true;
		else if(m.pl.key=='A' && m.pr.key=='C')
			pesaCmayADer1.visible=true;
		else if(m.pl.key=='C' && m.pr.key=='B')
			pesaCmayBIzq1.visible=true;
		else if(m.pl.key=='B' && m.pr.key=='C')
			pesaCmayBDer1.visible=true;
	}
	else if(m.name=="2")
	{
		mBdone=true;
		pivImg2.visible=false;
		if(m.pl.key=='A' && m.pr.key=='A')
			pesaAigualA2.visible=true;
		else if(m.pl.key=='B' && m.pr.key=='B')
			pesaBigualB2.visible=true;
		else if(m.pl.key=='C' && m.pr.key=='C')
			pesaCigualC2.visible=true;
		else if(m.pl.key=='A' && m.pr.key=='B')
			pesaBmayADer2.visible=true;
		else if(m.pl.key=='B' && m.pr.key=='A')
			pesaBmayAIzq2.visible=true;
		else if(m.pl.key=='C' && m.pr.key=='A')
			pesaCmayAIzq2.visible=true;
		else if(m.pl.key=='A' && m.pr.key=='C')
			pesaCmayADer2.visible=true;
		else if(m.pl.key=='C' && m.pr.key=='B')
			pesaCmayBIzq2.visible=true;
		else if(m.pl.key=='B' && m.pr.key=='C')
			pesaCmayBDer2.visible=true;
	}
	else if(m.name=="3")
	{
		mCdone=true;
		pivImg3.visible=false;
		if(m.pl.key=='A' && m.pr.key=='A')
			pesaAigualA3.visible=true;
		else if(m.pl.key=='B' && m.pr.key=='B')
			pesaBigualB3.visible=true;
		else if(m.pl.key=='C' && m.pr.key=='C')
			pesaCigualC3.visible=true;
		else if(m.pl.key=='A' && m.pr.key=='B')
			pesaBmayADer3.visible=true;
		else if(m.pl.key=='B' && m.pr.key=='A')
			pesaBmayAIzq3.visible=true;
		else if(m.pl.key=='C' && m.pr.key=='A')
			pesaCmayAIzq3.visible=true;
		else if(m.pl.key=='A' && m.pr.key=='C')
			pesaCmayADer3.visible=true;
		else if(m.pl.key=='C' && m.pr.key=='B')
			pesaCmayBIzq3.visible=true;
		else if(m.pl.key=='B' && m.pr.key=='C')
			pesaCmayBDer3.visible=true;
	}

	console.log(m);
	reloadRock(m.pl);
	reloadRock(m.pr);
}
function reloadRock(obj){
	var rock;
	var massRock=1;
	if (obj.key=='A'){
		rock=rocks.create(A_p[0],A_p[1],'A');
		massRock=8;
	} else if(obj.key=='B'){
		rock=rocks.create(B_p[0],B_p[1],'B');
		massRock=4;
	}else{
		rock=rocks.create(C_p[0],C_p[1],'C');
		massRock=3;
	}
	rock.body.collideWorldBounds = true;
	rock.body.mass=massRock;
	rock.inputEnabled=true;
	rock.input.enableDrag(false,true);
	rock.events.onDragStart.add(startDrag,this);
	rock.events.onDragStop.add(stopDrag,this);
}
function eraseMeasure1(){
	mAdone=false;
	pivImg1.visible=true;
	pesaAigualA1.visible=false;
	pesaBigualB1.visible=false;
	pesaCigualC1.visible=false;
	pesaBmayADer1.visible=false;
	pesaBmayAIzq1.visible=false;
	pesaCmayAIzq1.visible=false;
	pesaCmayADer1.visible=false;
	pesaCmayBIzq1.visible=false;
	pesaCmayBDer1.visible=false;
	console.log("me apretaron1");
	if (measure1.blockused==true){
		measure1.blockused=false;
		measure1.ok.visible=false;
		measure1.result.destroy();
		if (measure1.intable== true){
			measure1.intable=false;
			tableup.measures--;
			erasefull();
			sessionStorage.removeItem("b_m1");
		}
	}
	if (measure1.pl!=null){
		reloadRock(measure1.pl);
		measure1.pl.destroy();
		measure1.pl=null;
		measure1.plw=0;
	}
	if (measure1.pr!=null){
		reloadRock(measure1.pr);
		measure1.pr.destroy();
		measure1.prw=0;
		measure1.pr=null;
	}
}
function eraseMeasure2(){
	mBdone=false;
	pivImg2.visible=true;
	pesaAigualA2.visible=false;
	pesaBigualB2.visible=false;
	pesaCigualC2.visible=false;
	pesaBmayADer2.visible=false;
	pesaBmayAIzq2.visible=false;
	pesaCmayAIzq2.visible=false;
	pesaCmayADer2.visible=false;
	pesaCmayBIzq2.visible=false;
	pesaCmayBDer2.visible=false;
	console.log("me apretaron2");
	if (measure2.blockused==true){
		measure2.blockused=false;
		measure2.ok.visible=false;
		measure2.result.destroy();
		if (measure2.intable== true){
			measure2.intable=false;
			tableup.measures--;
			erasefull();
			sessionStorage.removeItem("b_m2");
		}
	}
	if (measure2.pl!=null){
		reloadRock(measure2.pl);
		measure2.pl.destroy();
		measure2.pl=null;
		measure2.plw=0;
	}
	if (measure2.pr!=null){
		reloadRock(measure2.pr);
		measure2.pr.destroy();
		measure2.prw=0;
		measure2.pr=null;
	}
}
function eraseMeasure3(){
	mCdone=false;
	pivImg3.visible=true;
	pesaAigualA3.visible=false;
	pesaBigualB3.visible=false;
	pesaCigualC3.visible=false;
	pesaBmayADer3.visible=false;
	pesaBmayAIzq3.visible=false;
	pesaCmayAIzq3.visible=false;
	pesaCmayADer3.visible=false;
	pesaCmayBIzq3.visible=false;
	pesaCmayBDer3.visible=false;
	console.log("me apretaron3");
	if (measure3.blockused==true){
		measure3.blockused=false;
		measure3.ok.visible=false;
		measure3.result.destroy();
		if (measure3.intable== true){
			measure3.intable=false;
			tableup.measures--;
			erasefull();
			sessionStorage.removeItem("b_m3");
		}
	}
	if (measure3.pl!=null){
		reloadRock(measure3.pl);
		measure3.pl.destroy();
		measure3.pl=null;
		measure3.plw=0;
	}
	if (measure3.pr!=null){
		reloadRock(measure3.pr);
		measure3.pr.destroy();
		measure3.prw=0;
		measure3.pr=null;
	}
}
function goTable1 (){
	if (measure1.blockused==true){
		if(textA!=null){
			textA.destroy();
			textA=null;
			tableup.measures--;
		}
		measure1.result.visible=true;
		measure1.intable= true;
		tableup.measures++;
		sessionStorage.setItem('b_m1', measure1.result._text);
		console.log(sessionStorage.getItem('b_m1'));
		checkfull();
	}
}
function goTable2 (){
	if (measure2.blockused==true){
		if(textB!=null){
			textB.destroy();
			textB=null;
			tableup.measures--;
		}
		measure2.result.visible=true;
		measure2.intable= true;
		tableup.measures++;
		sessionStorage.setItem('b_m2', measure2.result._text);
		console.log(sessionStorage.getItem('b_m2'));
		checkfull();
	}
}
function goTable3 (){
	if (measure3.blockused==true){
		if(textC!=null){
			textC.destroy();
			textC=null;
			tableup.measures--;
		}
		measure3.result.visible=true;
		measure3.intable= true;
		tableup.measures++;
		sessionStorage.setItem('b_m3', measure3.result._text);
		console.log(sessionStorage.getItem('b_m3'));
		checkfull();
	}
}
function goTools() {
	window.open("d10.html", "_self");
}
function goOrder(){
    var c=sessionStorage.getItem('cameFrom');
    sessionStorage.setItem('cameFrom', '0');
    if (c=='d12'){
        window.open("d12.html", "_self");   
    }else if(c=='d14'){
        window.open("d14.html", "_self"); 
    }
}
function goRight()
{
	window.open("d11.html", "_self");
}
function watch_tutorial()
{
	window.open("d1.html", "_self");
}
function startDrag(sprite){
	sprite.body.moves=false;
}
function stopDrag(sprite){
	sprite.body.moves=true;
}
function render() {
    //game.debug.inputInfo(32, 32);
}

</script>

</body>
</html>